@using Portal.Shared
@using Portal.Shared.DTO.Job

<Card ShowHeaderWithAddButton="true" HeaderTitle="Site Visits" OnAddButtonClick="OnAdd">
    <ChildContent>
        @if (SiteVisits.Count == 0)
        {
            <div class="empty-state">No records</div>
        }
        else
        {
            <div class="site-visits-container">
                @foreach (JobSiteVisitsDto visit in SiteVisits)
                {
                    <div class="site-visit-entry">
                        <div class="visit-fields">
                            <div class="visit-field">
                                <span class="visit-label">View</span>
                                <span class="visit-value">
                                    <div class="view-button-wrapper">
                                        <MudButton Href=@($"/schedule/{visit.Start.Date.ToString("yyyy-MM-dd")}/{(int)JobType}") Variant="Variant.Text" Color="Color.Primary" Size="Size.Small" StartIcon="@Icons.Material.Filled.RemoveRedEye" Class="view-button">View</MudButton>
                                    </div>
                                </span>
                            </div>
                            <div class="visit-field">
                                <span class="visit-label">Date</span>
                                <span class="visit-value">@visit.Start.Date.ToString("yyyy-MM-dd") | @visit.GetStartEndAsString()</span>
                            </div>
                            <div class="visit-field">
                                <span class="visit-label">Assignees</span>
                                <span class="visit-value">@visit.GetAssigneesAsString()</span>
                            </div>
                            <div class="visit-field">
                                <span class="visit-label">Category</span>
                                <span class="visit-value">@visit.Category</span>
                            </div>
                            <div class="visit-field">
                                <span class="visit-label">Notes</span>
                                <span class="visit-value">@visit.Notes</span>
                            </div>
                        </div>
                    </div>
                }
            </div>
        }
    </ChildContent>
</Card>

@code {
    [Parameter]
    public List<JobSiteVisitsDto> SiteVisits { get; set; } = new();

    [Parameter]
    public JobTypeEnum JobType{ get; set; }

    [Parameter]
    public EventCallback OnAdd { get; set; }
}

